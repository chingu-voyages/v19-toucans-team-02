let e=null;const t=async t=>{try{console.log("Logging in",t);const a={redirect_uri:window.location.origin};t&&(a.appState={targetUrl:t}),await e.loginWithRedirect(a)}catch(e){console.log("Log in failed",e)}},a=()=>{try{console.log("Logging out"),e.logout({returnTo:window.location.origin})}catch(e){console.log("Log out failed",e)}},o=()=>fetch("/auth_config.json"),n=async()=>{const t=await fetch("/auth_config.json"),a=await t.json();e=await createAuth0Client({domain:a.domain,client_id:a.clientId})},i=async(a,o)=>await e.isAuthenticated()?a():t(o);window.onload=async()=>{if(await n(),s(window.location.pathname)||(s("/"),window.history.replaceState({url:"/"},{},"/")),document.getElementsByTagName("body")[0].addEventListener("click",e=>{if(u(e.target)){const t=e.target.getAttribute("href");s(t)&&(e.preventDefault(),window.history.pushState({url:t},{},t))}}),await e.isAuthenticated())return console.log("> User is authenticated"),window.history.replaceState({},document.title,window.location.pathname),void h();console.log("> User not authenticated");const t=window.location.search;if(t.includes("code=")&&t.includes("state=")){console.log("> Parsing redirect");try{const t=await e.handleRedirectCallback();t.appState&&t.appState.targetUrl&&s(t.appState.targetUrl),console.log("Logged in!")}catch(e){console.log("Error parsing redirect:",e)}window.history.replaceState({},document.title,"/")}h()};class c{constructor(e,t,a){this.name=e,this.location=t,this.image=a}}class l{static displaySights(){[{name:"Bird one",location:"0, 0",image:"alpha.png"},{name:"Bird two",location:"1, 1",image:"beta.png"},{name:"Bird three",location:"2, 2",image:"gamma.png"}].forEach(e=>l.addSight(e))}static addSight(e){const t=document.querySelector("#sights"),a=document.createElement("tr");a.innerHTML=`\n        <td>${e.name}</td> \n        <td>${e.location}</td>\n        <td>${e.image}</td>\n        <td><a href="#">remove</a></td>\n        `,t.appendChild(a)}static clearForm(){document.querySelector("#name").value="",document.querySelector("#location").value="",document.querySelector("#image").value=""}static deleteSight(){}}document.addEventListener("DOMContentLoaded",l.displaySights),document.querySelector("#addSight").addEventListener("submit",e=>{e.preventDefault();const t=document.querySelector("#name").value,a=document.querySelector("#location").value,o=document.querySelector("#image").value,n=new c(t,a,o);console.log(n),l.addSight(n)});const r={"/":()=>g("content-home"),"/profile":()=>i(()=>g("content-profile"),"/profile"),"/login":()=>t()},d=(e,t)=>{for(let a of document.querySelectorAll(e))t(a)},s=e=>!!r[e]&&(r[e](),!0),u=e=>"A"===e.tagName&&e.classList.contains("route-link"),g=e=>{d(".page",e=>e.classList.add("hidden")),document.getElementById(e).classList.remove("hidden")},h=async()=>{try{if(await e.isAuthenticated()){const t=await e.getUser();document.getElementById("profile-data").innerText=JSON.stringify(t,null,2),document.querySelectorAll("pre code").forEach(hljs.highlightBlock),d(".profile-image",e=>e.src=t.picture),d(".user-name",e=>e.innerText=t.name),d(".user-email",e=>e.innerText=t.email),d(".auth-invisible",e=>e.classList.add("hidden")),d(".auth-visible",e=>e.classList.remove("hidden"))}else d(".auth-invisible",e=>e.classList.remove("hidden")),d(".auth-visible",e=>e.classList.add("hidden"))}catch(e){return void console.log("Error updating UI!",e)}console.log("UI updated")};window.onpopstate=e=>{e.state&&e.state.url&&r[e.state.url]&&s(e.state.url)};