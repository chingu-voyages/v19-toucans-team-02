let t=null;const e=async e=>{try{console.log("Logging in",e);const a={redirect_uri:window.location.origin};e&&(a.appState={targetUrl:e}),await t.loginWithRedirect(a)}catch(t){console.log("Log in failed",t)}},a=()=>{try{console.log("Logging out"),t.logout({returnTo:window.location.origin})}catch(t){console.log("Log out failed",t)}},o=()=>fetch("/auth_config.json"),n=async()=>{const e=await fetch("/auth_config.json"),a=await e.json();t=await createAuth0Client({domain:a.domain,client_id:a.clientId})},i=async(a,o)=>await t.isAuthenticated()?a():e(o);window.onload=async()=>{await n(),s(window.location.pathname)||(s("/"),window.history.replaceState({url:"/"},{},"/"));document.getElementsByTagName("body")[0].addEventListener("click",t=>{if(u(t.target)){const e=t.target.getAttribute("href");s(e)&&(t.preventDefault(),window.history.pushState({url:e},{},e))}});if(await t.isAuthenticated())return console.log("> User is authenticated"),window.history.replaceState({},document.title,window.location.pathname),void h();console.log("> User not authenticated");const e=window.location.search;if(e.includes("code=")&&e.includes("state=")){console.log("> Parsing redirect");try{const e=await t.handleRedirectCallback();e.appState&&e.appState.targetUrl&&s(e.appState.targetUrl),console.log("Logged in!")}catch(t){console.log("Error parsing redirect:",t)}window.history.replaceState({},document.title,"/")}h()};class c{constructor(t,e,a){this.name=t,this.location=e,this.image=a}}class l{static displaySights(){[{name:"Bird one",location:"0, 0",image:"alpha.png"},{name:"Bird two",location:"1, 1",image:"beta.png"},{name:"Bird three",location:"2, 2",image:"gamma.png"}].forEach(t=>l.addSight(t))}static addSight(t){const e=document.querySelector("#sights"),a=document.createElement("tr");a.innerHTML=`\n        <td>${t.name}</td> \n        <td>${t.location}</td>\n        <td>${t.image}</td>\n        <td><a href="#">remove</a></td>\n        `,e.appendChild(a)}static clearForm(){document.querySelector("#name").value="",document.querySelector("#location").value="",document.querySelector("#image").value=""}static deleteSight(){}}document.addEventListener("DOMContentLoaded",l.displaySights),document.querySelector("#addSight").addEventListener("submit",t=>{t.preventDefault();const e=document.querySelector("#name").value,a=document.querySelector("#location").value,o=document.querySelector("#image").value,n=new c(e,a,o);console.log(n),l.addSight(n)});const d={"/":()=>g("content-home"),"/profile":()=>i(()=>g("content-profile"),"/profile"),"/login":()=>e()},r=(t,e)=>{for(let a of document.querySelectorAll(t))e(a)},s=t=>!!d[t]&&(d[t](),!0),u=t=>"A"===t.tagName&&t.classList.contains("route-link"),g=t=>{r(".page",t=>t.classList.add("hidden")),document.getElementById(t).classList.remove("hidden")},h=async()=>{try{if(await t.isAuthenticated()){const e=await t.getUser();document.getElementById("profile-data").innerText=JSON.stringify(e,null,2),r(".auth-invisible",t=>t.classList.add("hidden")),r(".auth-visible",t=>t.classList.remove("hidden"))}else r(".auth-invisible",t=>t.classList.remove("hidden")),r(".auth-visible",t=>t.classList.add("hidden"))}catch(t){return void console.log("Error updating UI!",t)}console.log("UI updated")};window.onpopstate=t=>{t.state&&t.state.url&&d[t.state.url]&&s(t.state.url)};